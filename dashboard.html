<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de bord â€“ DÃ©vPerso</title>
    <meta name="description" content="Votre tableau de bord personnel DÃ©vPerso">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
        <a class="navbar-brand fw-bold fs-4" href="index.html">
            <i class="fas fa-brain me-2"></i>DÃ©vPerso
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menu">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="menu">
            <ul class="navbar-nav ms-auto align-items-center">
                <li class="nav-item"><a class="nav-link px-3" href="index.html">Accueil</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="challenges.html">Challenges</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="citation.html">Citations</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="affirmations.html">Affirmations</a></li>
                <li class="nav-item"><a class="nav-link px-3 active" href="dashboard.html">Tableau de bord</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="a propos.html">Ã€ propos</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="contact.html">Contact</a></li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle btn btn-outline-light btn-sm ms-2" href="#" id="langDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-globe"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" id="languageSelector">
                        <li><a class="dropdown-item" href="#" onclick="setLanguage('fr')">ðŸ‡«ðŸ‡· FranÃ§ais</a></li>
                        <li><a class="dropdown-item" href="#" onclick="setLanguage('en')">ðŸ‡¬ðŸ‡§ English</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a class="btn btn-primary ms-2 px-4" href="#" id="userMenu">
                        <i class="fas fa-user me-2"></i><span id="userName">Mon Compte</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Main Content -->
<main class="pt-5 mt-4">
    <div class="container py-5">
        <!-- Welcome Section -->
        <div class="welcome-section mb-5">
            <h1 class="display-4 fw-bold mb-2">
                <span class="text-gradient">Tableau de bord</span>
            </h1>
            <p class="lead text-muted">Suivez votre progression et consultez vos statistiques</p>
        </div>

        <!-- Stats Cards -->
        <div class="row g-4 mb-5">
            <div class="col-md-4">
                <div class="stat-card p-4 rounded-4 h-100">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon me-3">
                            <i class="fas fa-quote-left"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold mb-0" id="countDB">0</h3>
                            <p class="text-muted mb-0">Citations enregistrÃ©es</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card p-4 rounded-4 h-100">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon me-3">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold mb-0" id="countFav">0</h3>
                            <p class="text-muted mb-0">Favoris</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card p-4 rounded-4 h-100">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon me-3">
                            <i class="fas fa-star"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold mb-0" id="daily">-</h3>
                            <p class="text-muted mb-0">Citation du jour</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="row g-4 mb-5">
            <div class="col-md-6">
                <div class="action-card p-4 rounded-4 h-100">
                    <h4 class="fw-bold mb-4">
                        <i class="fas fa-bolt text-primary me-2"></i>Actions rapides
                    </h4>
                    <div class="d-flex flex-wrap gap-2">
                        <a href="citation.html" class="btn btn-outline-primary">
                            <i class="fas fa-plus me-2"></i>Nouvelle citation
                        </a>
                        <a href="affirmations.html" class="btn btn-outline-primary">
                            <i class="fas fa-sun me-2"></i>Affirmation du jour
                        </a>
                        <a href="challenges.html" class="btn btn-outline-primary">
                            <i class="fas fa-bullseye me-2"></i>Commencer un challenge
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="action-card p-4 rounded-4 h-100">
                    <h4 class="fw-bold mb-4">
                        <i class="fas fa-trophy text-warning me-2"></i>Votre progression
                    </h4>
                    <div class="progress-stats">
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span>Citations ajoutÃ©es</span>
                                <span class="fw-bold" id="progressQuotes">0</span>
                            </div>
                            <div class="progress" style="height: 8px;">
                                <div class="progress-bar bg-primary" role="progressbar" style="width: 0%" id="progressBarQuotes"></div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span>Favoris sauvegardÃ©s</span>
                                <span class="fw-bold" id="progressFavs">0</span>
                            </div>
                            <div class="progress" style="height: 8px;">
                                <div class="progress-bar bg-danger" role="progressbar" style="width: 0%" id="progressBarFavs"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Quotes -->
        <div class="row">
            <div class="col-12">
                <div class="recent-card p-4 rounded-4">
                    <h4 class="fw-bold mb-4">
                        <i class="fas fa-history text-muted me-2"></i>DerniÃ¨res citations enregistrÃ©es
                    </h4>
                    <ul id="lastQuotes" class="list-group list-group-flush">
                        <li class="list-group-item text-center text-muted py-4">
                            <i class="fas fa-inbox fa-2x mb-3 d-block"></i>
                            Aucune citation pour le moment
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Footer -->
<footer class="footer bg-dark text-white py-4 mt-5">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <p class="mb-0">Â© 2026 DÃ©vPerso â€“ Tous droits rÃ©servÃ©s</p>
            </div>
            <div class="col-md-6 text-md-end">
                <a href="privacy.html" class="text-white-50 me-3">ConfidentialitÃ©</a>
                <a href="terms.html" class="text-white-50 me-3">Conditions</a>
                <a href="cookies.html" class="text-white-50">Cookies</a>
            </div>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="auth.js"></script>
<script src="i18n.js"></script>
<script src="darkmode.js"></script>
<script>
    // Load user data
    const currentUser = getCurrentUser();
    if (currentUser) {
        document.getElementById('userName').textContent = currentUser.name;
    }

    // Load quotes data
    const db = JSON.parse(localStorage.getItem("quoteDB") || "[]");
    const favs = JSON.parse(localStorage.getItem("favorites") || "[]");
    const daily = JSON.parse(localStorage.getItem("dailyQuote") || "{}");

    // Update stats
    document.getElementById("countDB").innerText = db.length;
    document.getElementById("countFav").innerText = favs.length;
    document.getElementById("daily").innerText = daily.quote ? "âœ“" : "-";

    // Update progress
    const quoteGoal = 10;
    const favGoal = 5;
    document.getElementById('progressQuotes').innerText = db.length + '/' + quoteGoal;
    document.getElementById('progressFavs').innerText = favs.length + '/' + favGoal;
    document.getElementById('progressBarQuotes').style.width = Math.min((db.length / quoteGoal) * 100, 100) + '%';
    document.getElementById('progressBarFavs').style.width = Math.min((favs.length / favGoal) * 100, 100) + '%';

    // Load recent quotes
    const list = document.getElementById("lastQuotes");
    if (db.length > 0) {
        list.innerHTML = '';
        db.slice(-5).reverse().forEach(q => {
            list.innerHTML += `
                <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                    <span>${q.text || q}</span>
                    <button class="btn btn-sm btn-outline-danger" onclick="removeFromDB('${encodeURIComponent(q.text || q)}')">
                        <i class="fas fa-trash"></i>
                    </button>
                </li>
            `;
        });
    }

    function removeFromDB(quoteText) {
        let dbArray = JSON.parse(localStorage.getItem("quoteDB") || "[]");
        const text = decodeURIComponent(quoteText);
        dbArray = dbArray.filter(q => (q.text || q) !== text);
        localStorage.setItem("quoteDB", JSON.stringify(dbArray));
        location.reload();
    }

    // Widget quotes
    const widgetQuotes = [
        "Tu es capable de grandes choses.",
        "Chaque jour est une nouvelle opportunitÃ©.",
        "La constance bat le talent.",
        "Tu mÃ©rites le bonheur.",
        "Continue, tu es sur la bonne voie."
    ];
    
    // Check if there's a footer quote element
    const footerQuote = document.querySelector('.quote-widget p');
    if (footerQuote) {
        footerQuote.innerText = widgetQuotes[Math.floor(Math.random() * widgetQuotes.length)];
    }
</script>

<style>
.stat-card, .action-card, .recent-card {
    background: white;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    transition: var(--transition);
}

.stat-card:hover, .action-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.stat-icon {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(79, 70, 229, 0.1);
    color: var(--primary);
    border-radius: 12px;
    font-size: 1.25rem;
}

body.dark-mode .stat-card,
body.dark-mode .action-card,
body.dark-mode .recent-card {
    background: #1E293B;
}

body.dark-mode .list-group-item {
    background: #1E293B;
    color: #F8FAFC;
    border-color: #334155;
}

body.dark-mode .text-muted {
    color: #94A3B8 !important;
}
</style>

</body>
</html>
